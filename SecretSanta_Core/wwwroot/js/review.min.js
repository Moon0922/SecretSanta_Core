$(document).ready(function(){function e(n,t){var r="",f,e,o,s;r+="<input type='hidden' id='FamilyMemberId_"+t+"' class='member' value='"+n.familyMemberId+"'/>";r+="<div class='form-group'>";r+="<div class='row'>";r+=" <label for='Name_"+t+"' class='control-label col-md-4'>"+$("#Name").val()+"<\/label>";r+="<div class='col-md-8'>";r+="<input type='text' id='Name_"+t+"' class='form-control' value='"+n.name+"'/>";r+="<\/div>";r+="<\/div>";r+="<\/div>";r+="<div class='form-group'>";r+="<div class='row'>";r+=" <label for='Age_"+t+"' class='control-label col-md-4'>"+$("#Age").val()+"<\/label>";r+="<div class='col-md-8'>";r+="<input type='text' id='Age_"+t+"' class='form-control' value='"+n.age+"'/>";r+="<\/div>";r+="<\/div>";r+="<\/div>";f="<option value=''>Select<\/option>";$.each(u,function(t,i){f+=n.gender==i?"<option value='"+i+"' selected>"+i+"<\/option>":"<option value='"+i+"'>"+i+"<\/option>"});r+="<div class='form-group'>";r+="<div class='row'>";r+=" <label for='Gender_"+t+"' class='control-label col-md-4'>"+$("#Gender").val()+"<\/label>";r+="<div class='col-md-8'>";r+="<select id='Gender_"+t+"' class='form-control'>";r+=f;r+="<\/select>";r+="<\/div>";r+="<\/div>";r+="<\/div>";e="<option value=''>Select<\/option>";$.each(i,function(t,i){e+=n.warmClothingType==i?"<option value='"+i+"' selected>"+i+"<\/option>":"<option value='"+i+"'>"+i+"<\/option>"});r+="<div class='form-group'>";r+="<div class='row'>";r+="<div class='col-md-4' style ='text-align: right'><label class='control-label'>"+$("#WarmClothingSize").val()+"<\/label><\/div>";r+="<div class='col-md-8 info-button'>";r+="<a class='btnInfo' class='info btn' title='"+$("#WarmClothingSizeInfo").val()+"'>";r+="<i class='fa fa-info-circle'><\/i>";r+="<\/a>";r+="<\/div>";r+="<\/div>";r+="<\/div>";r+="<div class='form-group'>";r+="<div class='row'>";r+="<div class='col-md-4'><label for='WarmClothingSize' class='control-label'>"+$("#Size").val()+"<\/label><\/div>";r+="<div class='col-md-4'>";r+="<input type='text' id='WarmClothingSize_"+t+"' class='form-control' value='"+n.warmClothingSize+"'/>";r+="<\/div>";r+="<div class='col-md-4'>";r+="<select id='WarmClothingType_"+t+"' class='form-control'>";r+=e;r+="<\/select>";r+="<\/div>";r+="<\/div>";r+="<\/div>";o="<option value=''>Select<\/option>";$.each(i,function(t,i){o+=n.shoeSizeType==i?"<option value='"+i+"' selected>"+i+"<\/option>":"<option value='"+i+"'>"+i+"<\/option>"});r+="<div class='form-group'>";r+="<div class='row'>";r+=" <label for='ShoeSize_"+t+"' class='control-label col-md-4'>"+$("#ShoeSize").val()+"<\/label>";r+="<div class='col-md-4'>";r+="<input type='text' id='ShoeSize_"+t+"' class='form-control' value='"+n.shoeSize+"'/>";r+="<\/div>";r+="<div class='col-md-4'>";r+="<select id='ShoeSizeType_"+t+"' class='form-control'>";r+=o;r+="<\/select>";r+="<\/div>";r+="<\/div>";r+="<\/div>";r+="<div class='form-group'>";r+="<div class='row'>";r+=" <label for='Likes_"+t+"' class='control-label col-md-4'>"+$("#Likes").val()+"<\/label>";r+="<div class='col-md-8'>";r+="<textarea id='Likes_"+t+"' class='form-control' rows='10'>"+n.likes+"<\/textarea>";r+="<\/div>";r+="<\/div>";r+="<\/div>";r+="<div class='form-group'>";r+="<div class='row'>";r+=" <label for='OtherRequests_"+t+"' class='control-label col-md-4'>"+$("#OtherRequests").val()+"<\/label>";r+="<div class='col-md-8'>";s=n.otherRequests!=null?n.otherRequests:"";r+="<textarea id='OtherRequests_"+t+"' class='form-control' rows='10'>"+s+"<\/textarea>";r+="<\/div>";r+="<\/div>";r+="<\/div>";$("#familyMembers").append(r)}function o(){var t="",r,f,e;t+="<input type='hidden' id='FamilyMemberId_"+n+"' class='member' value='0'/>";t+="<div class='form-group'>";t+="<div class='row'>";t+=" <label for='Name_"+n+"' class='control-label col-md-4'>"+$("#Name").val()+"<\/label>";t+="<div class='col-md-8'>";t+="<input type='text' id='Name_"+n+"' class='form-control', maxlength='150'/>";t+="<\/div>";t+="<\/div>";t+="<\/div>";t+="<div class='form-group'>";t+="<div class='row'>";t+=" <label for='Age_"+n+"' class='control-label col-md-4'>"+$("#Age").val()+"<\/label>";t+="<div class='col-md-8'>";t+="<input type='text' id='Age_"+n+"' class='form-control' />";t+="<\/div>";t+="<\/div>";t+="<\/div>";r="<option value=''>Select<\/option>";$.each(u,function(n,t){r+="<option value='"+t+"'>"+t+"<\/option>"});t+="<div class='form-group'>";t+="<div class='row'>";t+=" <label for='Gender_"+n+"' class='control-label col-md-4'>"+$("#Gender").val()+"<\/label>";t+="<div class='col-md-8'>";t+="<select id='Gender_"+n+"' class='form-control'>";t+=r;t+="<\/select>";t+="<\/div>";t+="<\/div>";t+="<\/div>";f="<option value=''>Select<\/option>";$.each(i,function(n,t){f+="<option value='"+t+"'>"+t+"<\/option>"});t+="<div class='row'>";t+="<div class='col-md-4' style ='text-align: right'><label class='control-label'>"+$("#WarmClothingSize").val()+"<\/label><\/div>";t+="<div class='col-md-8 info-button'>";t+="<a class='btnInfo' class='info btn' title='"+$("#WarmClothingSizeInfo").val()+"'>";t+="<i class='fa fa-info-circle'><\/i>";t+="<\/a>";t+="<\/div>";t+="<\/div>";t+="<div class='row'>";t+="<div class='col-md-4'><label for='WarmClothingSize' class='control-label'>"+$("#Size").val()+"<\/label><\/div>";t+="<div class='col-md-4'>";t+="<input type='text' id='WarmClothingSize_"+n+"' class='form-control', maxlength='25'/>";t+="<\/div>";t+="<div class='col-md-4'>";t+="<select id='WarmClothingType_"+n+"' class='form-control'>";t+=f;t+="<\/select>";t+="<\/div>";t+="<\/div>";e="<option value=''>Select<\/option>";$.each(i,function(n,t){e+="<option value='"+t+"'>"+t+"<\/option>"});t+="<div class='form-group'>";t+="<div class='row'>";t+=" <label for='ShoeSize_"+n+"' class='control-label col-md-4'>"+$("#ShoeSize").val()+"<\/label>";t+="<div class='col-md-4'>";t+="<input type='text' id='ShoeSize_"+n+"' class='form-control', maxlength='25'/>";t+="<\/div>";t+="<div class='col-md-4'>";t+="<select id='ShoeSizeType_"+n+"' class='form-control'>";t+=e;t+="<\/select>";t+="<\/div>";t+="<\/div>";t+="<\/div>";t+="<div class='form-group'>";t+="<div class='row'>";t+=" <label for='Likes_"+n+"' class='control-label col-md-4'>"+$("#Likes").val()+"<\/label>";t+="<div class='col-md-8'>";t+="<textarea id='Likes_"+n+"' class='form-control' rows='10'><\/textarea>";t+="<\/div>";t+="<\/div>";t+="<\/div>";t+="<div class='form-group'>";t+="<div class='row'>";t+=" <label for='OtherRequests_"+n+"' class='control-label col-md-4'>"+$("#OtherRequests").val()+"<\/label>";t+="<div class='col-md-8'>";t+="<textarea id='OtherRequests_"+n+"' class='form-control' rows='10'><\/textarea>";t+="<\/div>";t+="<\/div>";t+="<\/div>";$("#familyMembers").append(t);$([document.documentElement,document.body]).animate({scrollTop:$("#Name_"+n).offset().top},2e3);$("#Name_"+n).focus();n++}function s(){$("#errorMessage").empty();t="";r=[];``;var n=$("#review").valid(),i=parseInt($("#NumChildrenUnder19").val())+parseInt($("#NumChildrenOver19").val())+parseInt($("#NumParents").val())+parseInt($("#NumGrandparents").val())+parseInt($("#NumOtherFamily").val())+parseInt($("#NumFriends").val());return i===0&&(n=!1,t+=$("#FamilyCountWarning").val()+ + "<br/>"),$(".member").each(function(){var i=$(this).attr("id"),u=i.replace("FamilyMemberId","Name"),f=i.replace("FamilyMemberId","Age"),e=i.replace("FamilyMemberId","Gender"),o=i.replace("FamilyMemberId","WarmClothingSize"),s=i.replace("FamilyMemberId","WarmClothingType"),h=i.replace("FamilyMemberId","ShoeSize"),c=i.replace("FamilyMemberId","ShoeSizeType"),l=i.replace("FamilyMemberId","Likes"),a=i.replace("FamilyMemberId","OtherRequests"),v=$("#"+u).val()!=""&&$("#"+f).val()!=""&&$("#"+e).val()!=""&&$("#"+o).val()!=""&&$("#"+s).val()!=""&&$("#"+h).val()!=""&&$("#"+c).val()!=""&&$("#"+l).val()!="",p=$("#"+u).val()==""&&$("#"+f).val()==""&&$("#"+e).val()==""&&$("#"+o).val()==""&&$("#"+s).val()==""&&$("#"+h).val()==""&&$("#"+c).val()==""&&$("#"+l).val()==""&&$("#"+a).val()=="",y;v||p||(n=!1,t+=$("#FamilyMemberWarning").val()+"<br/>");v&&(y={FamilyMemberId:$(this).val(),Name:$("#"+u).val(),Age:$("#"+f).val(),Gender:$("#"+e).val(),WarmClothingSize:$("#"+o).val(),WarmClothingType:$("#"+s).val(),ShoeSize:$("#"+h).val(),ShoeSizeType:$("#"+c).val(),Likes:$("#"+l).val(),OtherRequests:$("#"+a).val()},r.push(y))}),n}function f(){var n={LetterId:$("#LetterId").val(),Language:$("#Language").val(),Address:$("#Address").val(),City:$("#City").val(),Zip:$("#Zip").val(),Phone:$("#Phone").val(),Email:$("#Email").val(),NumChildrenUnder19:$("#NumChildrenUnder19").val(),NumChildrenOver19:$("#NumChildrenOver19").val(),NumParents:$("#NumParents").val(),NumGrandparents:$("#NumGrandparents").val(),NumOtherFamily:$("#NumOtherFamily").val(),Letter:$("#Letter").val(),FirstName:$("#FirstName").val(),LastName:$("#LastName").val(),WriterName:$("#WriterName").val(),NumFriends:$("#NumFriends").val()!=null?$("#NumFriends").val():0,FamilyMembers:r};$.ajax({dataType:"json",url:"/SantaLetter/SaveReview",data:n,type:"POST",success:function(){window.location.href="/SantaLetter/Disclaimer"},error:function(){window.location.href="/Error"}})}var i=["Boys","Girls","Mens","Womens"],u=["M","F","NB"],n,t="",r=[];$.ajax({dataType:"json",url:"/SantaLetter/GetFamilyMembers",data:{letterId:$("#LetterId").val()},type:"POST",success:function(t){if(n=t.familyMembers.length,t.familyMembers.length>0)for(var i=0;i<t.familyMembers.length;i++)e(t.familyMembers[i],i)},error:function(){window.location.href="/Error"}});$("#familyMembers").on("click",".btnInfo",function(){$("#modalInfo").modal("show")});$("#next").click(function(){var i=s(),n;i?(n={Address:$("#Address").val(),City:$("#City").val(),Zip:$("#Zip").val()},$.ajax({dataType:"json",url:"/SantaLetter/VerifyAddress",data:n,type:"POST",success:function(n){n.status==="suggested"?($("#suggested_address").html(n.suggestedAddress.address),$("#suggested_city").html(n.suggestedAddress.city),$("#suggested_zip").html(n.suggestedAddress.zip),$("#modalSuggestedAddress").modal("show")):f()},error:function(){window.location.href="/Error"}})):($("#errorMessage").html(t),t!==""&&$("#modalWarning").modal("show"))});$("#addFamilyMember").click(function(){o()});$("#submit").click(function(){$("#use_suggested").is(":checked")&&($("#Address").val($("#suggested_address").html()),$("#City").val($("#suggested_city").html()),$("#Zip").val($("#suggested_zip").html()));f()})});